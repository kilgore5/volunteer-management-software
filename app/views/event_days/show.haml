- day = @event_day

- content_for :hero_title do
  = "#{@event_day.event.name}: #{@event_day.date.strftime("%A")}, #{@event_day.date.strftime("%d/%m/%Y")}"
- content_for :cta do
  %button.btn.btn-lg.btn-info{"data-target" => "##{@event_day.date}", "data-toggle" => "modal", :type => "button"}
    Add jobs +

.row 
  .col-sm-6.col-xs-12.event_day.event_day
    .panel.default
      .top-key-factor
        .badge-container
          %span.badge.excellent EXCELLENT
        .centerify-icon
          %span.icon
        .event_day__title
          %h5
            Jobs Assigned [#{day.jobs.count}]
        %hr    
        .event_day__inner
          %br
          %table{class: "table table-sm table-bordered"}
            %thead
              %tr
                %th
                  Job
                %th
                  Rotations
                %th
                  Shifts                  
            %tbody
              - day.jobs.each do |job|
                %tr
                  %td
                    = job.title
                  %td
                    = link_to job.rotations_required_per_day, event_day_rotations_path(day.id, job_id: job.id) 
                  %td
                    / # TODO get this logic out of view
                    = job.rotations_required_per_day * job.workers_per_rotation
              %tr.table-info
                %td
                  Daily Totals
                %td
                  = day.total_rotations
                %td
                  = day.total_workers_needed                    

          %br
  .col-sm-6.col-xs-12.event_day.event_day
    .panel.default
      .top-key-factor
        .badge-container
          %span.badge.excellent EXCELLENT
        .centerify-icon
          %span.icon       
        .event_day__title
          %h5
            Volunteers
        %hr    
        .event_day__inner
          = "Volunteers needed: #{day.total_workers_needed}"
          %br 
        .event_day__inner
          = "Total Rotations: #{day.total_rotations}"
          %br                       
                                                                     

.modal.fade{:id =>  day.date }
  .modal-dialog{:role => "document"}
    .modal-content
      .modal-header
        %h5.modal-title Add jobs for #{day.date.strftime("%A")}
        %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
          %span{"aria-hidden" => "true"} Ã—
      = simple_form_for day, url: event_event_day_path(@event, day) do |f|
        .modal-body

          = f.association :jobs


        .modal-footer
          = f.button :submit
          %button.btn.btn-secondary{"data-dismiss" => "modal", :type => "button"} Close 