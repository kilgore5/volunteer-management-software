%h5
  My Applications
.user-details.panel.default
  - if @user.applications.empty?
    .row
      .col-md-12
        %small.form-text.text-muted You don't have any current applications. Check back soon for new events to apply for.
  - @user.applications.each do |app|
    - case app.state
    - when "submitted"
      - status_label = "default"
    - when "accepted"
      - status_label = "success"
    - when "waitlisted"
      - status_label = "warning"
    - when "denied"
      - status_label = "danger"
    - when "confirmed"
      - status_label = "success"

    .row
      .col-md-4
        %h6= app.event.name
      .col-md-5
        Application Status:
        %span.label{ class: "label-#{status_label}" }
          = app.state.titleize
      .col-md-3
        / # = link_to 'Edit my application', edit_apply_path(app)
        %i Applications are closed
      %br
      %hr
      .col-md-3
        = "Actions:"
      .col-md-9
        - if app.accepted?
          - if app.confirmed?
            %span{style: "color: green;"}
              Your volunteer spot is secure.  You'll soon receive your shift schedule.
          - else
            - unless @customer && @customer.sources.total_count > 0
              %div
                = link_to "Confirm my spot", accept_invitation_apply_path(app), class: "btn btn-success disabled", disabled: true, data: { confirm: "Securing your spot requires a $15 volunteer t-shirt purchase; this will be charged to your card." }
                = link_to "Decline", decline_invitation_apply_path(app), class: "btn btn-default", data: { confirm: "Are you sure?" }
              %div
                %span.small.form-text.text-muted
                  You need to add a payment method below to secure your spot.
            - else
              = link_to "Confirm my spot", accept_invitation_apply_path(app), class: "btn btn-success", data: { confirm: "Securing your spot requires a $15 volunteer t-shirt purchase; this will be charged to your card." }
              = link_to "Decline", decline_invitation_apply_path(app), class: "btn btn-default", data: { confirm: "Are you sure?" }
        - elsif app.submitted?
          %div
            %span.small.form-text.text-muted
              Please hang tight while we review the applications - you'll receive an email with further instructions shortly.
        - elsif app.confirmed?
          %div
            %span.small.form-text.text-muted
              Your spot is secure!
              %br
              Welcome to the team.  Watch your email for important announcements about your shift or upcoming meetings.
        - else
          %div
            %span.small.form-text.text-muted
              No actions at this time. Please get in contact (volunteers@strawberry-fields.com.au) with any questions.

      .col-md-12
        %hr
        %span.small
          This site is developed by web agency 'Built in Code'. Charges will show up in your bank from Built in Code LLC.